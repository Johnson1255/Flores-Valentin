(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();function Ln(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Ps(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var n=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return s[r]}})}),t}var Qe,pr;function Un(){if(pr)return Qe;pr=1;var s=Object.prototype.toString;return Qe=function(t){var r=s.call(t),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&s.call(t.callee)==="[object Function]"),n},Qe}var Xe,yr;function Os(){if(yr)return Xe;yr=1;var s;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,r=Un(),n=Object.prototype.propertyIsEnumerable,i=!n.call({toString:null},"toString"),o=n.call(function(){},"prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(d){var p=d.constructor;return p&&p.prototype===d},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},u=function(){if(typeof window>"u")return!1;for(var d in window)try{if(!c["$"+d]&&e.call(window,d)&&window[d]!==null&&typeof window[d]=="object")try{l(window[d])}catch{return!0}}catch{return!0}return!1}(),h=function(d){if(typeof window>"u"||!u)return l(d);try{return l(d)}catch{return!1}};s=function(p){var v=p!==null&&typeof p=="object",w=t.call(p)==="[object Function]",m=r(p),O=v&&t.call(p)==="[object String]",P=[];if(!v&&!w&&!m)throw new TypeError("Object.keys called on a non-object");var f=o&&w;if(O&&p.length>0&&!e.call(p,0))for(var y=0;y<p.length;++y)P.push(String(y));if(m&&p.length>0)for(var g=0;g<p.length;++g)P.push(String(g));else for(var _ in p)!(f&&_==="prototype")&&e.call(p,_)&&P.push(String(_));if(i)for(var S=h(p),T=0;T<a.length;++T)!(S&&a[T]==="constructor")&&e.call(p,a[T])&&P.push(a[T]);return P}}return Xe=s,Xe}var Ye,gr;function As(){if(gr)return Ye;gr=1;var s=Array.prototype.slice,e=Un(),t=Object.keys,r=t?function(o){return t(o)}:Os(),n=Object.keys;return r.shim=function(){if(Object.keys){var o=function(){var a=Object.keys(arguments);return a&&a.length===arguments.length}(1,2);o||(Object.keys=function(l){return e(l)?n(s.call(l)):n(l)})}else Object.keys=r;return Object.keys||r},Ye=r,Ye}var Ze,vr;function Ge(){if(vr)return Ze;vr=1;var s=Object.defineProperty||!1;if(s)try{s({},"a",{value:1})}catch{s=!1}return Ze=s,Ze}var et,mr;function qn(){return mr||(mr=1,et=SyntaxError),et}var tt,_r;function Ae(){return _r||(_r=1,tt=TypeError),tt}var rt,wr;function Es(){return wr||(wr=1,rt=Object.getOwnPropertyDescriptor),rt}var nt,br;function Je(){if(br)return nt;br=1;var s=Es();if(s)try{s([],"length")}catch{s=null}return nt=s,nt}var st,Sr;function Dn(){if(Sr)return st;Sr=1;var s=Ge(),e=qn(),t=Ae(),r=Je();return st=function(i,o,a){if(!i||typeof i!="object"&&typeof i!="function")throw new t("`obj` must be an object or a function`");if(typeof o!="string"&&typeof o!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,h=arguments.length>6?arguments[6]:!1,d=!!r&&r(i,o);if(s)s(i,o,{configurable:u===null&&d?d.configurable:!u,enumerable:l===null&&d?d.enumerable:!l,value:a,writable:c===null&&d?d.writable:!c});else if(h||!l&&!c&&!u)i[o]=a;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},st}var it,kr;function Fn(){if(kr)return it;kr=1;var s=Ge(),e=function(){return!!s};return e.hasArrayLengthDefineBug=function(){if(!s)return null;try{return s([],"length",{value:1}).length!==1}catch{return!0}},it=e,it}var ot,Pr;function Bn(){if(Pr)return ot;Pr=1;var s=As(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",t=Object.prototype.toString,r=Array.prototype.concat,n=Dn(),i=function(c){return typeof c=="function"&&t.call(c)==="[object Function]"},o=Fn()(),a=function(c,u,h,d){if(u in c){if(d===!0){if(c[u]===h)return}else if(!i(d)||!d())return}o?n(c,u,h,!0):n(c,u,h)},l=function(c,u){var h=arguments.length>2?arguments[2]:{},d=s(u);e&&(d=r.call(d,Object.getOwnPropertySymbols(u)));for(var p=0;p<d.length;p+=1)a(c,d[p],u[d[p]],h[d[p]])};return l.supportsDescriptors=!!o,ot=l,ot}var at={exports:{}},lt,Or;function Nn(){return Or||(Or=1,lt=Object),lt}var ct,Ar;function Ts(){return Ar||(Ar=1,ct=Error),ct}var ut,Er;function Rs(){return Er||(Er=1,ut=EvalError),ut}var ht,Tr;function js(){return Tr||(Tr=1,ht=RangeError),ht}var dt,Rr;function $s(){return Rr||(Rr=1,dt=ReferenceError),dt}var ft,jr;function Cs(){return jr||(jr=1,ft=URIError),ft}var pt,$r;function Is(){return $r||($r=1,pt=Math.abs),pt}var yt,Cr;function xs(){return Cr||(Cr=1,yt=Math.floor),yt}var gt,Ir;function Ls(){return Ir||(Ir=1,gt=Math.max),gt}var vt,xr;function Us(){return xr||(xr=1,vt=Math.min),vt}var mt,Lr;function qs(){return Lr||(Lr=1,mt=Math.pow),mt}var _t,Ur;function Ds(){return Ur||(Ur=1,_t=Math.round),_t}var wt,qr;function Fs(){return qr||(qr=1,wt=Number.isNaN||function(e){return e!==e}),wt}var bt,Dr;function Bs(){if(Dr)return bt;Dr=1;var s=Fs();return bt=function(t){return s(t)||t===0?t:t<0?-1:1},bt}var St,Fr;function Ns(){return Fr||(Fr=1,St=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||a.enumerable!==!0)return!1}return!0}),St}var kt,Br;function Ms(){if(Br)return kt;Br=1;var s=typeof Symbol<"u"&&Symbol,e=Ns();return kt=function(){return typeof s!="function"||typeof Symbol!="function"||typeof s("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},kt}var Pt,Nr;function Mn(){return Nr||(Nr=1,Pt=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Pt}var Ot,Mr;function zn(){if(Mr)return Ot;Mr=1;var s=Nn();return Ot=s.getPrototypeOf||null,Ot}var At,zr;function zs(){if(zr)return At;zr=1;var s="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,r="[object Function]",n=function(l,c){for(var u=[],h=0;h<l.length;h+=1)u[h]=l[h];for(var d=0;d<c.length;d+=1)u[d+l.length]=c[d];return u},i=function(l,c){for(var u=[],h=c,d=0;h<l.length;h+=1,d+=1)u[d]=l[h];return u},o=function(a,l){for(var c="",u=0;u<a.length;u+=1)c+=a[u],u+1<a.length&&(c+=l);return c};return At=function(l){var c=this;if(typeof c!="function"||e.apply(c)!==r)throw new TypeError(s+c);for(var u=i(arguments,1),h,d=function(){if(this instanceof h){var O=c.apply(this,n(u,arguments));return Object(O)===O?O:this}return c.apply(l,n(u,arguments))},p=t(0,c.length-u.length),v=[],w=0;w<p;w++)v[w]="$"+w;if(h=Function("binder","return function ("+o(v,",")+"){ return binder.apply(this,arguments); }")(d),c.prototype){var m=function(){};m.prototype=c.prototype,h.prototype=new m,m.prototype=null}return h},At}var Et,Gr;function Ee(){if(Gr)return Et;Gr=1;var s=zs();return Et=Function.prototype.bind||s,Et}var Tt,Jr;function or(){return Jr||(Jr=1,Tt=Function.prototype.call),Tt}var Rt,Hr;function ar(){return Hr||(Hr=1,Rt=Function.prototype.apply),Rt}var jt,Wr;function Gs(){return Wr||(Wr=1,jt=typeof Reflect<"u"&&Reflect&&Reflect.apply),jt}var $t,Vr;function Gn(){if(Vr)return $t;Vr=1;var s=Ee(),e=ar(),t=or(),r=Gs();return $t=r||s.call(t,e),$t}var Ct,Kr;function Jn(){if(Kr)return Ct;Kr=1;var s=Ee(),e=Ae(),t=or(),r=Gn();return Ct=function(i){if(i.length<1||typeof i[0]!="function")throw new e("a function is required");return r(s,t,i)},Ct}var It,Qr;function Js(){if(Qr)return It;Qr=1;var s=Jn(),e=Je(),t;try{t=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var r=!!t&&e&&e(Object.prototype,"__proto__"),n=Object,i=n.getPrototypeOf;return It=r&&typeof r.get=="function"?s([r.get]):typeof i=="function"?function(a){return i(a==null?a:n(a))}:!1,It}var xt,Xr;function Hs(){if(Xr)return xt;Xr=1;var s=Mn(),e=zn(),t=Js();return xt=s?function(n){return s(n)}:e?function(n){if(!n||typeof n!="object"&&typeof n!="function")throw new TypeError("getProto: not an object");return e(n)}:t?function(n){return t(n)}:null,xt}var Lt,Yr;function Hn(){if(Yr)return Lt;Yr=1;var s=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Ee();return Lt=t.call(s,e),Lt}var Ut,Zr;function Wn(){if(Zr)return Ut;Zr=1;var s,e=Nn(),t=Ts(),r=Rs(),n=js(),i=$s(),o=qn(),a=Ae(),l=Cs(),c=Is(),u=xs(),h=Ls(),d=Us(),p=qs(),v=Ds(),w=Bs(),m=Function,O=function(N){try{return m('"use strict"; return ('+N+").constructor;")()}catch{}},P=Je(),f=Ge(),y=function(){throw new a},g=P?function(){try{return arguments.callee,y}catch{try{return P(arguments,"callee").get}catch{return y}}}():y,_=Ms()(),S=Hs(),T=zn(),C=Mn(),Re=ar(),X=or(),D={},je=typeof Uint8Array>"u"||!S?s:S(Uint8Array),B={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?s:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?s:ArrayBuffer,"%ArrayIteratorPrototype%":_&&S?S([][Symbol.iterator]()):s,"%AsyncFromSyncIteratorPrototype%":s,"%AsyncFunction%":D,"%AsyncGenerator%":D,"%AsyncGeneratorFunction%":D,"%AsyncIteratorPrototype%":D,"%Atomics%":typeof Atomics>"u"?s:Atomics,"%BigInt%":typeof BigInt>"u"?s:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?s:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?s:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?s:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float16Array%":typeof Float16Array>"u"?s:Float16Array,"%Float32Array%":typeof Float32Array>"u"?s:Float32Array,"%Float64Array%":typeof Float64Array>"u"?s:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?s:FinalizationRegistry,"%Function%":m,"%GeneratorFunction%":D,"%Int8Array%":typeof Int8Array>"u"?s:Int8Array,"%Int16Array%":typeof Int16Array>"u"?s:Int16Array,"%Int32Array%":typeof Int32Array>"u"?s:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":_&&S?S(S([][Symbol.iterator]())):s,"%JSON%":typeof JSON=="object"?JSON:s,"%Map%":typeof Map>"u"?s:Map,"%MapIteratorPrototype%":typeof Map>"u"||!_||!S?s:S(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":P,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?s:Promise,"%Proxy%":typeof Proxy>"u"?s:Proxy,"%RangeError%":n,"%ReferenceError%":i,"%Reflect%":typeof Reflect>"u"?s:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?s:Set,"%SetIteratorPrototype%":typeof Set>"u"||!_||!S?s:S(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?s:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":_&&S?S(""[Symbol.iterator]()):s,"%Symbol%":_?Symbol:s,"%SyntaxError%":o,"%ThrowTypeError%":g,"%TypedArray%":je,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?s:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?s:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?s:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?s:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?s:WeakMap,"%WeakRef%":typeof WeakRef>"u"?s:WeakRef,"%WeakSet%":typeof WeakSet>"u"?s:WeakSet,"%Function.prototype.call%":X,"%Function.prototype.apply%":Re,"%Object.defineProperty%":f,"%Object.getPrototypeOf%":T,"%Math.abs%":c,"%Math.floor%":u,"%Math.max%":h,"%Math.min%":d,"%Math.pow%":p,"%Math.round%":v,"%Math.sign%":w,"%Reflect.getPrototypeOf%":C};if(S)try{null.error}catch(N){var We=S(S(N));B["%Error.prototype%"]=We}var Ve=function N(E){var I;if(E==="%AsyncFunction%")I=O("async function () {}");else if(E==="%GeneratorFunction%")I=O("function* () {}");else if(E==="%AsyncGeneratorFunction%")I=O("async function* () {}");else if(E==="%AsyncGenerator%"){var R=N("%AsyncGeneratorFunction%");R&&(I=R.prototype)}else if(E==="%AsyncIteratorPrototype%"){var x=N("%AsyncGenerator%");x&&S&&(I=S(x.prototype))}return B[E]=I,I},$e={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Y=Ee(),H=Hn(),vs=Y.call(X,Array.prototype.concat),ms=Y.call(Re,Array.prototype.splice),fr=Y.call(X,String.prototype.replace),Ce=Y.call(X,String.prototype.slice),_s=Y.call(X,RegExp.prototype.exec),ws=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,bs=/\\(\\)?/g,Ss=function(E){var I=Ce(E,0,1),R=Ce(E,-1);if(I==="%"&&R!=="%")throw new o("invalid intrinsic syntax, expected closing `%`");if(R==="%"&&I!=="%")throw new o("invalid intrinsic syntax, expected opening `%`");var x=[];return fr(E,ws,function(M,se,L,Ie){x[x.length]=L?fr(Ie,bs,"$1"):se||M}),x},ks=function(E,I){var R=E,x;if(H($e,R)&&(x=$e[R],R="%"+x[0]+"%"),H(B,R)){var M=B[R];if(M===D&&(M=Ve(R)),typeof M>"u"&&!I)throw new a("intrinsic "+E+" exists, but is not available. Please file an issue!");return{alias:x,name:R,value:M}}throw new o("intrinsic "+E+" does not exist!")};return Ut=function(E,I){if(typeof E!="string"||E.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof I!="boolean")throw new a('"allowMissing" argument must be a boolean');if(_s(/^%?[^%]*%?$/,E)===null)throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var R=Ss(E),x=R.length>0?R[0]:"",M=ks("%"+x+"%",I),se=M.name,L=M.value,Ie=!1,Ke=M.alias;Ke&&(x=Ke[0],ms(R,vs([0,1],Ke)));for(var xe=1,me=!0;xe<R.length;xe+=1){var G=R[xe],Le=Ce(G,0,1),Ue=Ce(G,-1);if((Le==='"'||Le==="'"||Le==="`"||Ue==='"'||Ue==="'"||Ue==="`")&&Le!==Ue)throw new o("property names with quotes must have matching quotes");if((G==="constructor"||!me)&&(Ie=!0),x+="."+G,se="%"+x+"%",H(B,se))L=B[se];else if(L!=null){if(!(G in L)){if(!I)throw new a("base intrinsic for "+E+" exists, but the property is not available.");return}if(P&&xe+1>=R.length){var qe=P(L,G);me=!!qe,me&&"get"in qe&&!("originalValue"in qe.get)?L=qe.get:L=L[G]}else me=H(L,G),L=L[G];me&&!Ie&&(B[se]=L)}}return L},Ut}var qt,en;function Ws(){if(en)return qt;en=1;var s=Wn(),e=Dn(),t=Fn()(),r=Je(),n=Ae(),i=s("%Math.floor%");return qt=function(a,l){if(typeof a!="function")throw new n("`fn` is not a function");if(typeof l!="number"||l<0||l>4294967295||i(l)!==l)throw new n("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],u=!0,h=!0;if("length"in a&&r){var d=r(a,"length");d&&!d.configurable&&(u=!1),d&&!d.writable&&(h=!1)}return(u||h||!c)&&(t?e(a,"length",l,!0,!0):e(a,"length",l)),a},qt}var Dt,tn;function Vs(){if(tn)return Dt;tn=1;var s=Ee(),e=ar(),t=Gn();return Dt=function(){return t(s,e,arguments)},Dt}var rn;function Vn(){return rn||(rn=1,function(s){var e=Ws(),t=Ge(),r=Jn(),n=Vs();s.exports=function(o){var a=r(arguments),l=o.length-(arguments.length-1);return e(a,1+(l>0?l:0),!0)},t?t(s.exports,"apply",{value:n}):s.exports.apply=n}(at)),at.exports}var Ft,nn;function Ks(){if(nn)return Ft;nn=1;var s=Ae();return Ft=function(t){if(t==null)throw new s(arguments.length>0&&arguments[1]||"Cannot call method on "+t);return t},Ft}var Bt,sn;function Qs(){if(sn)return Bt;sn=1;var s=Wn(),e=Vn(),t=e(s("String.prototype.indexOf"));return Bt=function(n,i){var o=s(n,!!i);return typeof o=="function"&&t(n,".prototype.")>-1?e(o):o},Bt}var Nt,on;function Kn(){if(on)return Nt;on=1;var s=Ks(),e=Qs(),t=e("Object.prototype.propertyIsEnumerable"),r=e("Array.prototype.push");return Nt=function(i){var o=s(i),a=[];for(var l in o)t(o,l)&&r(a,[l,o[l]]);return a},Nt}var Mt,an;function Qn(){if(an)return Mt;an=1;var s=Kn();return Mt=function(){return typeof Object.entries=="function"?Object.entries:s},Mt}var zt,ln;function Xs(){if(ln)return zt;ln=1;var s=Qn(),e=Bn();return zt=function(){var r=s();return e(Object,{entries:r},{entries:function(){return Object.entries!==r}}),r},zt}var Gt,cn;function Ys(){if(cn)return Gt;cn=1;var s=Bn(),e=Vn(),t=Kn(),r=Qn(),n=Xs(),i=e(r(),Object);return s(i,{getPolyfill:r,implementation:t,shim:n}),Gt=i,Gt}var Jt,un;function Zs(){if(un)return Jt;un=1;var s=function(){};return Jt=s,Jt}var Ht,hn;function ei(){if(hn)return Ht;hn=1;var s=Ys(),e=Zs(),t=Hn(),r=function(y){e(!1,y)},n=String.prototype.replace,i=String.prototype.split,o="||||",a=function(f){var y=f%100,g=y%10;return y!==11&&g===1?0:2<=g&&g<=4&&!(y>=12&&y<=14)?1:2},l={pluralTypes:{arabic:function(f){if(f<3)return f;var y=f%100;return y>=3&&y<=10?3:y>=11?4:5},bosnian_serbian:a,chinese:function(){return 0},croatian:a,french:function(f){return f>=2?1:0},german:function(f){return f!==1?1:0},russian:a,lithuanian:function(f){return f%10===1&&f%100!==11?0:f%10>=2&&f%10<=9&&(f%100<11||f%100>19)?1:2},czech:function(f){return f===1?0:f>=2&&f<=4?1:2},polish:function(f){if(f===1)return 0;var y=f%10;return 2<=y&&y<=4&&(f%100<10||f%100>=20)?1:2},icelandic:function(f){return f%10!==1||f%100===11?1:0},slovenian:function(f){var y=f%100;return y===1?0:y===2?1:y===3||y===4?2:3},romanian:function(f){if(f===1)return 0;var y=f%100;return f===0||y>=2&&y<=19?1:2},ukrainian:a},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is","mk"],slovenian:["sl-SL"],romanian:["ro"],ukrainian:["uk","ua"]}};function c(f){for(var y={},g=s(f),_=0;_<g.length;_+=1)for(var S=g[_][0],T=g[_][1],C=0;C<T.length;C+=1)y[T[C]]=S;return y}function u(f,y){var g=c(f.pluralTypeToLanguages);return g[y]||g[i.call(y,/-/,1)[0]]||g.en}function h(f,y,g){return f.pluralTypes[y](g)}function d(){var f={};return function(y,g){var _=f[g];return _&&!y.pluralTypes[_]&&(_=null,f[g]=_),_||(_=u(y,g),_&&(f[g]=_)),_}}function p(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(f){var y=f&&f.prefix||"%{",g=f&&f.suffix||"}";if(y===o||g===o)throw new RangeError('"'+o+'" token is reserved for pluralization');return new RegExp(p(y)+"(.*?)"+p(g),"g")}var w=d(),m=/%\{(.*?)\}/g;function O(f,y,g,_,S,T){if(typeof f!="string")throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(y==null)return f;var C=f,Re=_||m,X=T||n,D=typeof y=="number"?{smart_count:y}:y;if(D.smart_count!=null&&f){var je=S||l,B=i.call(f,o),We=g||"en",Ve=w(je,We),$e=h(je,Ve,D.smart_count);C=n.call(B[$e]||B[0],/^[^\S]*|[^\S]*$/g,"")}return C=X.call(C,Re,function(Y,H){return!t(D,H)||D[H]==null?Y:D[H]}),C}function P(f){var y=f||{};this.phrases={},this.extend(y.phrases||{}),this.currentLocale=y.locale||"en";var g=y.allowMissing?O:null;this.onMissingKey=typeof y.onMissingKey=="function"?y.onMissingKey:g,this.warn=y.warn||r,this.replaceImplementation=y.replace||n,this.tokenRegex=v(y.interpolation),this.pluralRules=y.pluralRules||l}return P.prototype.locale=function(f){return f&&(this.currentLocale=f),this.currentLocale},P.prototype.extend=function(f,y){for(var g=s(f||{}),_=0;_<g.length;_+=1){var S=g[_][0],T=g[_][1],C=y?y+"."+S:S;typeof T=="object"?this.extend(T,C):this.phrases[C]=T}},P.prototype.unset=function(f,y){if(typeof f=="string")delete this.phrases[f];else for(var g=s(f||{}),_=0;_<g.length;_+=1){var S=g[_][0],T=g[_][1],C=y?y+"."+S:S;typeof T=="object"?this.unset(T,C):delete this.phrases[C]}},P.prototype.clear=function(){this.phrases={}},P.prototype.replace=function(f){this.clear(),this.extend(f)},P.prototype.t=function(f,y){var g,_,S=y??{};if(typeof this.phrases[f]=="string")g=this.phrases[f];else if(typeof S._=="string")g=S._;else if(this.onMissingKey){var T=this.onMissingKey;_=T(f,S,this.currentLocale,this.tokenRegex,this.pluralRules,this.replaceImplementation)}else this.warn('Missing translation for key: "'+f+'"'),_=f;return typeof g=="string"&&(_=O(g,S,this.currentLocale,this.tokenRegex,this.pluralRules,this.replaceImplementation)),_},P.prototype.has=function(f){return t(this.phrases,f)},P.transformPhrase=function(y,g,_){return O(y,g,_)},Ht=P,Ht}var ti=ei();const ri=Ln(ti);class ni{constructor(){this.polyglot=new ri,this.currentLocale="es",this.phrases={es:{},en:{}},this.loadTranslations(),this.setLocale(this.getSavedLocale()||this.currentLocale)}loadTranslations(){this.phrases.es={welcome:"Bienvenido a Flores San Valentín",slogan:"Arreglos florales únicos y personalizados",shopcart:"Mi Carrito de Compras",home:"Inicio",catalog:"Catálogo",gallery:"Galería",location:"Ubicación",contact:"Contacto",special_order:"Pedido Especial",buy_now:"Comprar Ahora",auth_login:"Iniciar Sesión",auth_logout:"Cerrar Sesión",phone:"Teléfono",email:"Correo Electrónico",address:"Dirección",opening_hours:"Horario de atención",monday_friday:"Lunes a Viernes: 9:00 - 20:00",saturday:"Sábados: 9:00 - 18:00",sunday:"Domingos: 10:00 - 14:00",contact_us:"Contacto",name:"Nombre",message:"Mensaje",send:"Enviar",directions:"Cómo llegar",visit_us:"Visítanos",our_catalog:"Nuestro Catálogo",red_roses:"Rosas Rojas",red_roses_desc:"Ramos elegantes de rosas rojas, perfectos para expresar amor y pasión.",tulips:"Tulipanes",tulips_desc:"Arreglos coloridos de tulipanes holandeses frescos.",orchids:"Orquídeas",orchids_desc:"Elegantes arreglos de orquídeas para ocasiones especiales.",from:"Desde",view_details:"Ver detalles",image_gallery:"Galería de Imágenes",our_location:"Nuestra Ubicación",about_us:"Sobre Nosotros",about_us_desc:"Somos especialistas en arreglos florales únicos y personalizados. Con más de 15 años de experiencia llevando belleza y color a momentos especiales.",follow_us:"Síguenos",all_rights_reserved:"Todos los derechos reservados.",privacy_policy:"Política de Privacidad",terms_conditions:"Términos y Condiciones",cookie_policy:"Política de Cookies",login:"Iniciar Sesión",register:"Registrarse",welcome_flowers:"Bienvenido a Flores San Valentín",login_message:"Para continuar con tu compra, por favor inicia sesión o crea una cuenta nueva",password:"Contraseña",remember_me:"Recordarme",forgot_password:"¿Olvidaste tu contraseña?",or_login_with:"O inicia sesión con",back_to_home:"Volver al inicio",create_account:"Crear Cuenta",personal_info:"Información Personal",first_name:"Nombre",last_name:"Apellidos",phone_number:"Teléfono",country:"País",city:"Ciudad",neighborhood:"Barrio",delivery_address:"Dirección de Entrega",postal_code:"Código Postal",confirm_password:"Confirmar Contraseña",occasions:"Ocasiones de interés (opcional)",birthdays:"Cumpleaños",anniversaries:"Aniversarios",weddings:"Bodas",condolences:"Condolencias",newsletter:"Deseo recibir ofertas y novedades por correo electrónico",terms_accept:"Acepto los términos y condiciones y la política de privacidad*"},this.phrases.en={welcome:"Welcome to Valentine's Flowers",slogan:"Unique and personalized floral arrangements",shopcart:"My Shopping Cart",home:"Home",catalog:"Catalog",gallery:"Gallery",location:"Location",contact:"Contact",special_order:"Special Order",buy_now:"Buy Now",auth_login:"Sign In",auth_logout:"Log Out",phone:"Phone",email:"Email",address:"Address",opening_hours:"Opening Hours",monday_friday:"Monday to Friday: 9:00 - 20:00",saturday:"Saturday: 9:00 - 18:00",sunday:"Sunday: 10:00 - 14:00",contact_us:"Contact Us",name:"Name",message:"Message",send:"Send",directions:"Get Directions",visit_us:"Visit Us",our_catalog:"Our Catalog",red_roses:"Red Roses",red_roses_desc:"Elegant red rose bouquets, perfect for expressing love and passion.",tulips:"Tulips",tulips_desc:"Colorful arrangements of fresh Dutch tulips.",orchids:"Orchids",orchids_desc:"Elegant orchid arrangements for special occasions.",from:"From",view_details:"View Details",image_gallery:"Image Gallery",our_location:"Our Location",about_us:"About Us",about_us_desc:"We specialize in unique and personalized floral arrangements. With over 15 years of experience bringing beauty and color to special moments.",follow_us:"Follow Us",all_rights_reserved:"All rights reserved.",privacy_policy:"Privacy Policy",terms_conditions:"Terms and Conditions",cookie_policy:"Cookie Policy",login:"Login",register:"Register",welcome_flowers:"Welcome to Valentine's Flowers",login_message:"To continue with your purchase, please login or create a new account",password:"Password",remember_me:"Remember me",forgot_password:"Forgot your password?",or_login_with:"Or login with",back_to_home:"Back to home",create_account:"Create Account",personal_info:"Personal Information",first_name:"First Name",last_name:"Last Name",phone_number:"Phone Number",country:"Country",city:"City",neighborhood:"Neighborhood",delivery_address:"Delivery Address",postal_code:"Postal Code",confirm_password:"Confirm Password",occasions:"Occasions of interest (optional)",birthdays:"Birthdays",anniversaries:"Anniversaries",weddings:"Weddings",condolences:"Condolences",newsletter:"I want to receive offers and news by email",terms_accept:"I accept the terms and conditions and privacy policy*"}}getSavedLocale(){return localStorage.getItem("preferred_language")}setLocale(e){return this.phrases[e]?(this.currentLocale=e,this.polyglot.locale(e),this.polyglot.replace(this.phrases[e]),localStorage.setItem("preferred_language",e),this.updatePageContent(),!0):!1}t(e,t={}){return this.polyglot.t(e,t)}updatePageContent(){document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n");e.textContent=this.t(t)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{const t=e.getAttribute("data-i18n-placeholder");e.placeholder=this.t(t)}),document.querySelectorAll("[data-i18n-value]").forEach(e=>{const t=e.getAttribute("data-i18n-value");e.value=this.t(t)})}}const dn=new ni;class sa{constructor(){this.availableLanguages={es:"Español",en:"English"},this.init()}init(){this.createSelector()}createSelector(){const e=document.createElement("select");e.id="language-selector",e.classList.add("language-selector"),Object.entries(this.availableLanguages).forEach(([o,a])=>{const l=document.createElement("option");l.value=o,l.textContent=a,e.appendChild(l)}),e.value=dn.currentLocale,e.addEventListener("change",o=>{dn.setLocale(o.target.value)});const t=document.createElement("div");t.classList.add("language-selector-container");const r=document.createElement("i");r.classList.add("fas","fa-globe"),t.appendChild(r),t.appendChild(e);const n=document.createElement("style");n.textContent=`
      .language-selector-container {
        display: flex;
        align-items: center;
        margin-left: 15px;
      }
      
      .language-selector-container i {
        margin-right: 5px;
        color: #555;
      }
      
      .language-selector {
        padding: 3px 5px;
        border-radius: 4px;
        border: 1px solid #ccc;
        background-color: white;
        cursor: pointer;
        font-size: 0.8rem;
      }
      
      /* Estilos para tema oscuro */
      body.dark-mode .language-selector {
        background-color: #333;
        color: #fff;
        border-color: #555;
      }
      
      body.dark-mode .language-selector-container i {
        color: #ccc;
      }
    `,document.head.appendChild(n);const i=document.querySelector(".social-icons");if(i){const o=document.querySelector("#theme-toggle");o?i.insertBefore(t,o):i.appendChild(t)}else{const o=document.querySelector(".top-bar-right");o&&o.appendChild(t)}}}const si="modulepreload",ii=function(s){return"/Flores-Valentin/"+s},fn={},ye=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if(l=ii(l),l in fn)return;fn[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":si,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((d,p)=>{h.addEventListener("load",d),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},oi=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>ye(async()=>{const{default:r}=await Promise.resolve().then(()=>ve);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class lr extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class ai extends lr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class li extends lr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ci extends lr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Yt;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Yt||(Yt={}));var ui=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};class hi{constructor(e,{headers:t={},customFetch:r,region:n=Yt.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=oi(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return ui(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=t;let a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:c}).catch(v=>{throw new ai(v)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new li(u);if(!u.ok)throw new ci(u);let d=((r=u.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return d==="application/json"?p=yield u.json():d==="application/octet-stream"?p=yield u.blob():d==="text/event-stream"?p=u:d==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null}}catch(n){return{data:null,error:n}}})}}var j={},ie={},oe={},ae={},le={},ce={},di=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ge=di();const fi=ge.fetch,Xn=ge.fetch.bind(ge),Yn=ge.Headers,pi=ge.Request,yi=ge.Response,ve=Object.freeze(Object.defineProperty({__proto__:null,Headers:Yn,Request:pi,Response:yi,default:Xn,fetch:fi},Symbol.toStringTag,{value:"Module"})),gi=Ps(ve);var De={},pn;function Zn(){if(pn)return De;pn=1,Object.defineProperty(De,"__esModule",{value:!0});class s extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return De.default=s,De}var yn;function es(){if(yn)return ce;yn=1;var s=ce&&ce.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ce,"__esModule",{value:!0});const e=s(gi),t=s(Zn());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let p=null,v=null,w=null,m=c.status,O=c.statusText;if(c.ok){if(this.method!=="HEAD"){const g=await c.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?v=g:v=JSON.parse(g))}const f=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),y=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");f&&y&&y.length>1&&(w=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(p={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,w=null,m=406,O="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const f=await c.text();try{p=JSON.parse(f),Array.isArray(p)&&c.status===404&&(v=[],p=null,m=200,O="OK")}catch{c.status===404&&f===""?(m=204,O="No Content"):p={message:f}}if(p&&this.isMaybeSingle&&(!((d=p==null?void 0:p.details)===null||d===void 0)&&d.includes("0 rows"))&&(p=null,m=200,O="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:v,count:w,status:m,statusText:O}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c==null?void 0:c.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return ce.default=r,ce}var gn;function ts(){if(gn)return le;gn=1;var s=le&&le.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(le,"__esModule",{value:!0});const e=s(es());class t extends e.default{select(n){let i=!1;const o=(n??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${n}`),this}range(n,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return le.default=t,le}var vn;function cr(){if(vn)return ae;vn=1;var s=ae&&ae.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ae,"__esModule",{value:!0});const e=s(ts());class t extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${l}fts${c}.${i}`),this}match(n){return Object.entries(n).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(n,i,o){return this.url.searchParams.append(n,`not.${i}.${o}`),this}or(n,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${n})`),this}filter(n,i,o){return this.url.searchParams.append(n,`${i}.${o}`),this}}return ae.default=t,ae}var mn;function rs(){if(mn)return oe;mn=1;var s=oe&&oe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(oe,"__esModule",{value:!0});const e=s(cr());class t{constructor(n,{headers:i={},schema:o,fetch:a}){this.url=n,this.headers=i,this.schema=o,this.fetch=a}select(n,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((d,p)=>d.concat(Object.keys(p)),[]);if(h.length>0){const d=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return oe.default=t,oe}var _e={},we={},_n;function vi(){return _n||(_n=1,Object.defineProperty(we,"__esModule",{value:!0}),we.version=void 0,we.version="0.0.0-automated"),we}var wn;function mi(){if(wn)return _e;wn=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.DEFAULT_HEADERS=void 0;const s=vi();return _e.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${s.version}`},_e}var bn;function _i(){if(bn)return ie;bn=1;var s=ie&&ie.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ie,"__esModule",{value:!0});const e=s(rs()),t=s(cr()),r=mi();class n{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${o}`);let p;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([w,m])=>m!==void 0).map(([w,m])=>[w,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([w,m])=>{d.searchParams.append(w,m)})):(h="POST",p=a);const v=Object.assign({},this.headers);return u&&(v.Prefer=`count=${u}`),new t.default({method:h,url:d,headers:v,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return ie.default=n,ie}var Sn;function wi(){if(Sn)return j;Sn=1;var s=j&&j.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(j,"__esModule",{value:!0}),j.PostgrestError=j.PostgrestBuilder=j.PostgrestTransformBuilder=j.PostgrestFilterBuilder=j.PostgrestQueryBuilder=j.PostgrestClient=void 0;const e=s(_i());j.PostgrestClient=e.default;const t=s(rs());j.PostgrestQueryBuilder=t.default;const r=s(cr());j.PostgrestFilterBuilder=r.default;const n=s(ts());j.PostgrestTransformBuilder=n.default;const i=s(es());j.PostgrestBuilder=i.default;const o=s(Zn());return j.PostgrestError=o.default,j.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:o.default},j}var bi=wi();const Si=Ln(bi),{PostgrestClient:ki,PostgrestQueryBuilder:ia,PostgrestFilterBuilder:oa,PostgrestTransformBuilder:aa,PostgrestBuilder:la,PostgrestError:ca}=Si,Pi="2.11.2",Oi={"X-Client-Info":`realtime-js/${Pi}`},Ai="1.0.0",ns=1e4,Ei=1e3;var pe;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(pe||(pe={}));var q;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(q||(q={}));var F;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(F||(F={}));var Zt;(function(s){s.websocket="websocket"})(Zt||(Zt={}));var te;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(te||(te={}));class Ti{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+n));o=o+n;const l=r.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class ss{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var A;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(A||(A={}));const kn=(s,e,t={})=>{var r;const n=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=Ri(o,s,e,n),i),{})},Ri=(s,e,t,r)=>{const n=e.find(a=>a.name===s),i=n==null?void 0:n.type,o=t[s];return i&&!r.includes(i)?is(i,o):er(o)},is=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return Ii(e,t)}switch(s){case A.bool:return ji(e);case A.float4:case A.float8:case A.int2:case A.int4:case A.int8:case A.numeric:case A.oid:return $i(e);case A.json:case A.jsonb:return Ci(e);case A.timestamp:return xi(e);case A.abstime:case A.date:case A.daterange:case A.int4range:case A.int8range:case A.money:case A.reltime:case A.text:case A.time:case A.timestamptz:case A.timetz:case A.tsrange:case A.tstzrange:return er(e);default:return er(e)}},er=s=>s,ji=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},$i=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},Ci=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},Ii=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,r=s[t];if(s[0]==="{"&&r==="}"){let i;const o=s.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>is(e,a))}return s},xi=s=>typeof s=="string"?s.replace(" ","T"):s,os=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Wt{constructor(e,t,r={},n=ns){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Pn;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(Pn||(Pn={}));class Se{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Se.syncState(this.state,n,i,o),this.pendingDiffs.forEach(l=>{this.state=Se.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Se.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(m=>m.presence_ref),p=h.map(m=>m.presence_ref),v=u.filter(m=>p.indexOf(m.presence_ref)<0),w=h.filter(m=>d.indexOf(m.presence_ref)<0);v.length>0&&(a[c]=v),w.length>0&&(l[c]=w)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},r,n)}static syncDiff(e,t,r,n){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(p=>p.presence_ref),d=u.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...d)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,n(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return"metas"in n?t[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var On;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(On||(On={}));var An;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(An||(An={}));var J;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(J||(J={}));class ur{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=q.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Wt(this,F.join,this.params,this.timeout),this.rejoinTimer=new ss(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=q.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=q.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=q.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=q.errored,this.rejoinTimer.scheduleTimeout())}),this._on(F.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Se(this),this.broadcastEndpointURL=os(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e==null?void 0:e(J.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(J.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&n!==void 0?n:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(J.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,p=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,v=[];for(let w=0;w<p;w++){const m=d[w],{filter:{event:O,schema:P,table:f,filter:y}}=m,g=u&&u[w];if(g&&g.event===O&&g.schema===P&&g.table===f&&g.filter===y)v.push(Object.assign(Object.assign({},m),{id:g.id}));else{this.unsubscribe(),e==null||e(J.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(J.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(J.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(J.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=q.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(F.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const n=new Wt(this,F.leave,{},e);n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Wt(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=F;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let d=this._onMessage(o,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var v,w,m;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((m=(w=p.filter)===null||w===void 0?void 0:w.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===o}).map(p=>p.callback(d,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var v,w,m,O,P,f;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const y=p.id,g=(v=p.filter)===null||v===void 0?void 0:v.event;return y&&((w=t.ids)===null||w===void 0?void 0:w.includes(y))&&(g==="*"||(g==null?void 0:g.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const y=(P=(O=p==null?void 0:p.filter)===null||O===void 0?void 0:O.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return y==="*"||y===((f=t==null?void 0:t.event)===null||f===void 0?void 0:f.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof d=="object"&&"ids"in d){const v=d.data,{schema:w,table:m,commit_timestamp:O,type:P,errors:f}=v;d=Object.assign(Object.assign({},{schema:w,table:m,commit_timestamp:O,eventType:P,new:{},old:{},errors:f}),this._getPayloadRecords(v))}p.callback(d,r)})}_isClosed(){return this.state===q.closed}_isJoined(){return this.state===q.joined}_isJoining(){return this.state===q.joining}_isLeaving(){return this.state===q.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ur.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(F.close,{},e)}_onError(e){this._on(F.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=q.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=kn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=kn(e.columns,e.old_record)),t}}const Li=()=>{},Ui=typeof WebSocket<"u",qi=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Di{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Oi,this.params={},this.timeout=ns,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Li,this.conn=null,this.sendBuffer=[],this.serializer=new Ti,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>ye(async()=>{const{default:l}=await Promise.resolve().then(()=>ve);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Zt.websocket}`,this.httpEndpoint=os(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ss(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Ui){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Fi(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ye(async()=>{const{default:e}=await import("./browser-CKMM07bw.js").then(t=>t.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ai}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case pe.connecting:return te.Connecting;case pe.open:return te.Open;case pe.closing:return te.Closing;default:return te.Closed}}isConnected(){return this.connectionState()===te.Open}channel(e,t={config:{}}){const r=new ur(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(n=>{t&&n.updateJoinPayload({access_token:t}),n.joinedOnce&&n._isJoined()&&n._push(F.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Ei,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:n,payload:i,ref:o}=t;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${n} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(F.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([qi],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Fi{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=pe.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class hr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function $(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class Bi extends hr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class tr extends hr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Ni=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};const as=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>ye(async()=>{const{default:r}=await Promise.resolve().then(()=>ve);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Mi=()=>Ni(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ye(()=>Promise.resolve().then(()=>ve),void 0)).Response:Response}),rr=s=>{if(Array.isArray(s))return s.map(t=>rr(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,r])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=rr(r)}),e};var re=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};const Vt=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),zi=(s,e,t)=>re(void 0,void 0,void 0,function*(){const r=yield Mi();s instanceof r&&!(t!=null&&t.noResolveJson)?s.json().then(n=>{e(new Bi(Vt(n),s.status||500))}).catch(n=>{e(new tr(Vt(n),n))}):e(new tr(Vt(s),s))}),Gi=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),t))};function Te(s,e,t,r,n,i){return re(this,void 0,void 0,function*(){return new Promise((o,a)=>{s(t,Gi(e,r,n,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>zi(l,a,r))})})}function ze(s,e,t,r){return re(this,void 0,void 0,function*(){return Te(s,"GET",e,t,r)})}function K(s,e,t,r,n){return re(this,void 0,void 0,function*(){return Te(s,"POST",e,r,n,t)})}function Ji(s,e,t,r,n){return re(this,void 0,void 0,function*(){return Te(s,"PUT",e,r,n,t)})}function Hi(s,e,t,r){return re(this,void 0,void 0,function*(){return Te(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function ls(s,e,t,r,n){return re(this,void 0,void 0,function*(){return Te(s,"DELETE",e,r,n,t)})}var U=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};const Wi={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},En={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Vi{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=as(n)}uploadOrUpdate(e,t,r,n){return U(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},En),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n!=null&&n.headers&&(a=Object.assign(Object.assign({},a),n.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if($(i))return{data:null,error:i};throw i}})}upload(e,t,r){return U(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return U(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:En.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if($(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return U(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const i=yield K(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new hr("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}update(e,t,r){return U(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return U(this,void 0,void 0,function*(){try{return{data:yield K(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}copy(e,t,r){return U(this,void 0,void 0,function*(){try{return{data:{path:(yield K(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,r){return U(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield K(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,r){return U(this,void 0,void 0,function*(){try{const n=yield K(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}download(e,t){return U(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield ze(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if($(a))return{data:null,error:a};throw a}})}info(e){return U(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield ze(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:rr(r),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}exists(e){return U(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Hi(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if($(r)&&r instanceof tr){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return U(this,void 0,void 0,function*(){try{return{data:yield ls(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}})}list(e,t,r){return U(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Wi),t),{prefix:e||""});return{data:yield K(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if($(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Ki="2.7.1",Qi={"X-Client-Info":`storage-js/${Ki}`};var ue=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};class Xi{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Qi),t),this.fetch=as(r)}listBuckets(){return ue(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if($(e))return{data:null,error:e};throw e}})}getBucket(e){return ue(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return ue(this,void 0,void 0,function*(){try{return{data:yield K(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return ue(this,void 0,void 0,function*(){try{return{data:yield Ji(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ue(this,void 0,void 0,function*(){try{return{data:yield K(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ue(this,void 0,void 0,function*(){try{return{data:yield ls(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}})}}class Yi extends Xi{constructor(e,t={},r){super(e,t,r)}from(e){return new Vi(this.url,this.headers,e,this.fetch)}}const Zi="2.49.1";let be="";typeof Deno<"u"?be="deno":typeof document<"u"?be="web":typeof navigator<"u"&&navigator.product==="ReactNative"?be="react-native":be="node";const eo={"X-Client-Info":`supabase-js-${be}/${Zi}`},to={headers:eo},ro={schema:"public"},no={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},so={};var io=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};const oo=s=>{let e;return s?e=s:typeof fetch>"u"?e=Xn:e=fetch,(...t)=>e(...t)},ao=()=>typeof Headers>"u"?Yn:Headers,lo=(s,e,t)=>{const r=oo(t),n=ao();return(i,o)=>io(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:s;let c=new n(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",s),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},o),{headers:c}))})};var co=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};function uo(s){return s.replace(/\/$/,"")}function ho(s,e){const{db:t,auth:r,realtime:n,global:i}=s,{db:o,auth:a,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),i),accessToken:()=>co(this,void 0,void 0,function*(){return""})};return s.accessToken?u.accessToken=s.accessToken:delete u.accessToken,u}const cs="2.68.0",fe=30*1e3,nr=3,Kt=nr*fe,fo="http://localhost:9999",po="supabase.auth.token",yo={"X-Client-Info":`gotrue-js/${cs}`},sr="X-Supabase-Api-Version",us={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function go(s){return Math.round(Date.now()/1e3)+s}function vo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const z=()=>typeof window<"u"&&typeof document<"u",Z={tested:!1,writable:!1},ke=()=>{if(!z())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Z.tested)return Z.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Z.tested=!0,Z.writable=!0}catch{Z.tested=!0,Z.writable=!1}return Z.writable};function mo(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((r,n)=>{e[n]=r}),e}const hs=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>ye(async()=>{const{default:r}=await Promise.resolve().then(()=>ve);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},_o=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",ds=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Fe=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Be=async(s,e)=>{await s.removeItem(e)};function wo(s){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,n,i,o,a,l,c,u=0;for(s=s.replace("-","+").replace("_","/");u<s.length;)o=e.indexOf(s.charAt(u++)),a=e.indexOf(s.charAt(u++)),l=e.indexOf(s.charAt(u++)),c=e.indexOf(s.charAt(u++)),r=o<<2|a>>4,n=(a&15)<<4|l>>2,i=(l&3)<<6|c,t=t+String.fromCharCode(r),l!=64&&n!=0&&(t=t+String.fromCharCode(n)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class He{constructor(){this.promise=new He.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}He.promiseConstructor=Promise;function Tn(s){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=s.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(wo(r))}async function bo(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function So(s,e){return new Promise((r,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await s(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function ko(s){return("0"+s.toString(16)).substr(-2)}function Po(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,ko).join("")}async function Oo(s){const t=new TextEncoder().encode(s),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function Ao(s){return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Eo(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await Oo(s);return Ao(t)}async function he(s,e,t=!1){const r=Po();let n=r;t&&(n+="/PASSWORD_RECOVERY"),await ds(s,`${e}-code-verifier`,n);const i=await Eo(r);return[i,r===i?"plain":"s256"]}const To=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ro(s){const e=s.headers.get(sr);if(!e||!e.match(To))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class dr extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function b(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class jo extends dr{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function $o(s){return b(s)&&s.name==="AuthApiError"}class fs extends dr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ne extends dr{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class W extends ne{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Co(s){return b(s)&&s.name==="AuthSessionMissingError"}class Qt extends ne{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ne extends ne{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Me extends ne{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Io(s){return b(s)&&s.name==="AuthImplicitGrantRedirectError"}class Rn extends ne{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ir extends ne{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Xt(s){return b(s)&&s.name==="AuthRetryableFetchError"}class jn extends ne{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var xo=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};const ee=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Lo=[502,503,504];async function $n(s){var e;if(!_o(s))throw new ir(ee(s),0);if(Lo.includes(s.status))throw new ir(ee(s),s.status);let t;try{t=await s.json()}catch(i){throw new fs(ee(i),i)}let r;const n=Ro(s);if(n&&n.getTime()>=us["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new jn(ee(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new W}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new jn(ee(t),s.status,t.weak_password.reasons);throw new jo(ee(t),s.status||500,r)}const Uo=(s,e,t,r)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),t))};async function k(s,e,t,r){var n;const i=Object.assign({},r==null?void 0:r.headers);i[sr]||(i[sr]=us["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await qo(s,e,t+a,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function qo(s,e,t,r,n,i){const o=Uo(e,r,n,i);let a;try{a=await s(t,Object.assign({},o))}catch(l){throw console.error(l),new ir(ee(l),0)}if(a.ok||await $n(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await $n(l)}}function V(s){var e;let t=null;No(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=go(s.expires_in)));const r=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:r},error:null}}function Cn(s){const e=V(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Q(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function Do(s){return{data:s,error:null}}function Fo(s){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:i}=s,o=xo(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:n,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Bo(s){return s}function No(s){return s.access_token&&s.refresh_token&&s.expires_in}var Mo=function(s,e){var t={};for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(s);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(s,r[n])&&(t[r[n]]=s[r[n]]);return t};class zo{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=hs(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await k(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await k(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Q})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Mo(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await k(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Fo,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(b(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await k(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Q})}catch(t){if(b(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await k(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Bo});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(v=>{const w=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(v.split(";")[1].split("=")[1]);c[`${m}Page`]=w}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(b(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await k(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Q})}catch(t){if(b(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await k(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Q})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await k(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Q})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await k(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:r}}catch(t){if(b(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await k(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(b(t))return{data:null,error:t};throw t}}}const Go={getItem:s=>ke()?globalThis.localStorage.getItem(s):null,setItem:(s,e)=>{ke()&&globalThis.localStorage.setItem(s,e)},removeItem:s=>{ke()&&globalThis.localStorage.removeItem(s)}};function In(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}function Jo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const de={debug:!!(globalThis&&ke()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ps extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ho extends ps{}async function Wo(s,e,t){de.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),de.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){de.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,n.name);try{return await t()}finally{de.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,n.name)}}else{if(e===0)throw de.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new Ho(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(de.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Jo();const Vo={url:fo,storageKey:po,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:yo,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function xn(s,e,t){return await t()}class Pe{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Pe.nextInstanceID,Pe.nextInstanceID+=1,this.instanceID>0&&z()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Vo),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new zo({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=hs(n.fetch),this.lock=n.lock||xn,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:z()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Wo:this.lock=xn,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ke()?this.storage=Go:(this.memoryStorage={},this.storage=In(this.memoryStorage)):(this.memoryStorage={},this.storage=In(this.memoryStorage)),z()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${cs}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=mo(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),z()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Io(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return b(t)?{error:t}:{error:new fs("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:V}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,n;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await he(this.storage,this.storageKey)),i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:p,code_challenge_method:v},xform:V})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},channel:(n=d==null?void 0:d.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:V})}else throw new Ne("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Cn})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Cn})}else throw new Ne("You must provide either an email or phone number and a password");const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Qt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Fe(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(t??"").split("/");try{const{data:i,error:o}=await k(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:V});if(await Be(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Qt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(b(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:i,nonce:o}=e,a=await k(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:V}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Qt}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await he(this.storage,this.storageKey));const{error:h}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Ne("You must provide either an email or phone number.")}catch(a){if(b(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await k(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:V});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(b(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await he(this.storage,this.storageKey)),await k(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Do})}catch(i){if(b(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new W;const{error:n}=await k(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(b(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:o}=await k(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:n,options:i}=e,{data:o,error:a}=await k(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Ne("You must provide either an email or phone number and a type")}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Fe(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Kt:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Q}):await this._useSession(async t=>{var r,n,i;const{data:o,error:a}=t;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new W}:await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Q})})}catch(t){if(b(t))return Co(t)&&(await this._removeSession(),await Be(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new W;const o=n.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await he(this.storage,this.storageKey));const{data:c,error:u}=await k(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Q});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Tn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new W;const t=Date.now()/1e3;let r=t,n=!0,i=null;const o=Tn(e.access_token);if(o.exp&&(r=o.exp,n=r<=t),n){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(b(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new W;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!z())throw new Me("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Me(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Rn("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Me("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Rn("No code detected.");const{data:P,error:f}=await this._exchangeCodeForSession(e.code);if(f)throw f;const y=new URL(window.location.href);return y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",y.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new Me("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const p=d-u;p*1e3<=fe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const v=d-h;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,d,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,d,u);const{data:w,error:m}=await this._getUser(i);if(m)throw m;const O={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:O,redirectType:e.type},error:null}}catch(r){if(b(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Fe(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{error:i};const o=(r=n.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!($o(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Be(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=vo(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await he(this.storage,this.storageKey,!0));try{return await k(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(b(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(b(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await k(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return z()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(b(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:o}=t;if(o)throw o;return await k(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await So(async n=>(n>0&&await bo(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await k(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:V})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Xt(i)&&Date.now()+o-r<fe})}catch(r){if(this._debug(t,"error",r),b(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),z()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Fe(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const n=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Kt;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${Kt}s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),Xt(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new W;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new He;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new W;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),b(i)){const o={session:null,error:i};return Xt(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ds(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Be(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&z()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),fe);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/fe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${fe}ms, refresh threshold is ${nr} ticks`),n<=nr&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ps)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!z()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await he(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await k(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await k(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(b(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(b(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],n=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(n.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}Pe.nextInstanceID=0;const Ko=Pe;class Qo extends Ko{constructor(e){super(e)}}var Xo=function(s,e,t,r){function n(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((r=r.apply(s,e||[])).next())})};class Yo{constructor(e,t,r){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=uo(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:ro,realtime:so,auth:Object.assign(Object.assign({},no),{storageKey:l}),global:to},u=ho(r??{},c);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=lo(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new ki(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new hi(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Yi(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Xo(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Qo({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Di(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Zo=(s,e,t)=>new Yo(s,e,t),ea="https://qhlvoszmopvidpzgqlno.supabase.co",ta="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFobHZvc3ptb3B2aWRwemdxbG5vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE3OTI3MTksImV4cCI6MjA1NzM2ODcxOX0.rdpdqVAzIawVCdIZz8YuFUEAXMy0XqQBgzYjLvCMiow",Oe=Zo(ea,ta);async function ua(s,e,t){try{const{data:r,error:n}=await Oe.auth.signUp({email:s,password:e});if(n)throw n;if(r.user){const{error:i}=await Oe.from("profiles").update({first_name:t.nombre,last_name:t.apellidos,phone:t.telefono,country:t.pais,city:t.ciudad,neighborhood:t.barrio,address:t.direccion,postal_code:t.codigoPostal,preferences:t.ocasiones,newsletter:t.newsletter||!1}).eq("id",r.user.id);i&&console.error("Error al actualizar perfil:",i)}return{data:r,error:null}}catch(r){return console.error("Error en el registro:",r.message),{data:null,error:r}}}async function ha(s,e){try{const{data:t,error:r}=await Oe.auth.signInWithPassword({email:s,password:e});if(r)throw r;return{data:t,error:null}}catch(t){return console.error("Error en el inicio de sesión:",t.message),{data:null,error:t}}}async function da(){try{const{error:s}=await Oe.auth.signOut();if(s)throw s;window.location.href="/Flores-Valentin/login.html"}catch(s){console.error("Error al cerrar sesión:",s.message)}}async function fa(){try{const{data:s,error:e}=await Oe.auth.getSession();if(e)throw e;return s.session}catch(s){return console.error("Error al obtener la sesión:",s.message),null}}function ys(){return localStorage.getItem("theme")||"light"}function gs(s){document.documentElement.setAttribute("data-theme",s),s==="dark"?document.documentElement.setAttribute("data-bs-theme","dark"):document.documentElement.removeAttribute("data-bs-theme"),localStorage.setItem("theme",s)}function ra(){const e=ys()==="light"?"dark":"light";gs(e),console.log("Tema cambiado a:",e)}function na(){const s=ys();gs(s);const e=document.getElementById("theme-toggle");e?(e.addEventListener("click",ra),console.log("Botón de tema inicializado")):console.error("El botón de tema no se encontró en el DOM")}document.addEventListener("DOMContentLoaded",na);export{sa as L,dn as a,ha as b,da as c,Ln as d,fa as g,na as i,ua as s};
